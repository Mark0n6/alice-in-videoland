@import "compass/css3/";
@import "animation-studio";
@import "compass/reset";

// Variables
// Max dimensions of iPad retina: 2048-by-1536

html, body {
	background: #000;
	height: 100%
}

// Extendables
%visuallyhidden { // hidden from view, not from screen readers!
  position: absolute; 
  overflow: hidden; 
  clip: rect(0 0 0 0); 
  height: 1px; width: 1px; 
  margin: -1px; 
}

%hidden {
	display: none !important;
}

%shown {
	display: block !important;
}

%imgreplace {
	text-indent: 100%;
	white-space: nowrap;
	overflow: hidden;
}

// Helopers
// For browsers that don't support animation, some props will have default styles leaving them revealed.
// But if animation is allowed, we'll want to hide them :p
@include keyframes(hide-if-animation-enabled) {
    100% { opacity: 0; }
}

// Dialog

//p:not(.caption) { revisit if you want to make a more storybook version
p {
	@extend %visuallyhidden;
}

// Loading page
.loading {
	@extend %hidden;
}

.loading, .scene {
	margin: 0 auto;
	width: 800px;
}

// Scenes
// all but the park start hidden. // actually, under loading page, it's hidden too.
.scene:not(.scene-park) {
	@extend %hidden;
}

.scene.cue {
	@extend %shown;
}

// Pages
.page_sitting-in-the-park {
	@include background(image-url("bg_park1.jpg") no-repeat);
}

$sleepy-eyes: 'eyes';
.page_alice-is-bored {
	@include background(image-url("bg_park2.jpg") no-repeat);
	.eyes {
	  // @include animation-sequence($sleepy-eyes, 1s);
	  width: 124px; height: 57px;
	  top: 159px; left: 83px;
	}
}
// @include animation-sequence-sprite-generator($sleepy-eyes);
// @include animation-sequence-keyframes($sleepy-eyes);

.page_rabbit-appears {
	@include background(image-url("bg_park3.jpg") no-repeat);
	.blink {
		@include background(image-url("blink.svg") 0 100% no-repeat); //for animation-deprived viewers, leave eye open.
		@include background-size(100% auto);
		position: absolute;
		width: 100%; height: 100%;
		z-index: 2;
	}
	&.in-view .blink {
		@include animation(scene-blink .75s steps(5) 5 -1s alternate);			
	}
	.rabbit {
		@extend %imgreplace;
		@include background(image-url("rabbit_running.png"));
		width: 444px; height: 490px;
		position: absolute;
		top: 60%; margin-top: -245px;
		left: 50%; margin-left: -244px;
		z-index: 1;
		@include animation(hide-if-animation-enabled .01s forwards);
	}
	&.in-view .rabbit {
		@include animation(rabbit-run 10s forwards);
	}
}

//candidate for Animation Studio sans sprite gen as SVG sprite is here already
@include keyframes(scene-blink) {
    0% { background-position: 0 0; }
    100% { background-position: 0 125%; }
}

@include keyframes(rabbit-run) {
    0% { 
    	left: -100%;
    }
    50% {
    	top: 80%
    }
    100% { 
    	top: 60%;
    	left: 200%;
    }
}

.page_rabbit-chase {
	@include background(image-url("bg_park4.jpg") no-repeat);
}

.page_the-hole {
	@include background(image-url("../../storyboard/storyboard5.jpg") no-repeat);
}

.page_tunnels {
	@include background(image-url("../../storyboard/storyboard6.jpg") no-repeat);
}

.falling_frightened {
	@include background(image-url("../../storyboard/storyboard7.jpg") no-repeat);
}

.falling_curious {
	@include background(image-url("../../storyboard/storyboard8.jpg") no-repeat);
}

.falling_bored {
	@include background(image-url("../../storyboard/storyboard9.jpg") no-repeat);
}

.falling_sleeping {
	@include background(image-url("../../storyboard/storyboard10.jpg") no-repeat);
}

.falling_waking {
	@include background(image-url("../../storyboard/storyboard11.jpg") no-repeat);
}

.falling_weird {
	@include background(image-url("../../storyboard/storyboard12.jpg") no-repeat);
}

.falling_aftermath {
	@include background(image-url("../../storyboard/storyboard13.jpg") no-repeat);
}

.falling_lookit-cat {
	@include background(image-url("../../storyboard/storyboard14.jpg") no-repeat);
}

.falling_cat-reveal {
	@include background(image-url("../../storyboard/storyboard15.jpg") no-repeat);
}

.falling_cat-out {
	@include background(image-url("../../storyboard/storyboard16.jpg") no-repeat);
}

.scene-cut {
	@include background(image-url("../../storyboard/storyboard17.png") no-repeat);
}

.page_crash-landing {
	@include background(image-url("../../storyboard/storyboard18.jpg") no-repeat);
}

.page_credits {
	@include background(image-url("../../storyboard/storyboard19.jpg") no-repeat);
}

.page { 
	@extend %imgreplace;
	height:600px;
	position: relative;
	z-index: 0;
	@include background-size( auto 100%);
	@include background-origin( padding-box);
}


// The Tunnel
#to-tunnels {
	@extend %imgreplace;
	position: absolute;
	top: 175px; left: 385px;
	width: 245px; height: 95px;
}

#tunnel {
	position: relative;
}

//let Alice and Cheshire hover above
.page_falling { z-index: -1;}

// Cut
.scene-cut { 
	background: #000;
	height: 100%;
	position: fixed;
	top: 0; left: 50%;
	margin-left: -400px;
	@include transition(opacity 2s ease-out 2s);
	z-index: 10;
	&.cue {
		@include animation(fadeOutFromNone 2s forwards);
	}
}

@include keyframes(fadeOutFromNone) {
	// because transitioning from display: none doesn't work. 
	//http://stackoverflow.com/questions/8449933/animation-css3-display-opacity
    0% { opacity: 1;}
    1% { opacity: 1;}
    100% { opacity: 0; }
}


// Characters

// .alice-falling {
// 	background: #666;
// 	width: 200px; height: 200px;
// 	position: absolute;
// 	top: 0; left: 50%;
// 	margin-left: -200px;
// }

// .cheshire-cat {
// 	background: red;
// 	width: 100px; height: 50px;
// 	position: absolute;
// 	bottom: 0; right: 50%;
// 	margin-right: -200px; 
// }

// #tunnel.in-view {
// 	.alice-falling, .cheshire-cat {
// 		position: fixed;
// 	}
// }
